# Live Location on Webhook Overview

Live Location on Webhooks allow you to subscribe to location change events generated by HyperTrack SDK. Rather than making an API call, HyperTrack can send an HTTPS request to an endpoint that you specify when a location change event associated with a device in your account takes place.

Using Live Location on Webhooks requires the following:

* That you set up a HyperTrack account.
* That you integrate HyperTrack SDK in your application. See [Quickstart app for HyperTrack iOS SDK](#quickstart-ios) and/or [Quickstart app for HyperTrack Android SDK](#quickstart-android) for more details.
* That you deploy a publicly available, secure (HTTPS) endpoint for that URL that can handle Live Location on Webhook payloads specified in this documentation.

## Live Location on Webhook Activation

In order to activate Live Location on Webhook, please follow the steps outlined below.

### Step 1: Webhook HTTPS Endpoint Setup 

Contact us via help@hypertrack.com to let us know if you would like to configure webhook HTTPS url in HyperTrack platform. 

### Step 2: Webhook Registration Confirmation

Live Location on Webhook uses AWS SNS service. Once configured, after you subscribe to an endpoint, AWS SNS will send a subscription confirmation message to your endpoint. 

Your endpoint implementation must retrieve the SubscribeURL value from the subscription confirmation message and either visit the location specified by the SubscribeURL itself or make it available to you so that you can manually visit the SubscribeURL. When you visit the SubscribeURL, the response will contain an XML document containing an element SubscriptionArn that specifies the ARN for the subscription.

### Step 3: Processing Live Location on Webhook Payload

Once you have confirmed the registration URL above, you will see payload that is delivered like this:

```
{
"Type" : "Notification", 
"MessageId" : "19f653e6-4a81-5c32-80c1-06ec44b77ffc",
"TopicArn" : "arn:aws:sns:us-west-2:203867187697:78f6fd85-0989-4907-8db2-22688dd32c15",
"Message" : "[{\\"recorded_at\\": \\"2019-02-27T22:50:24.538000Z\\", \\"data\\": {\\"altitude\\": 495.2, \\"bearing\\": 90.0, \\"location\\": {\\"coordinates\\": [-6.2755, 57.6398983], \\"type\\": \\"Point\\"}, \\"location_accuracy\\": 14.087, \\"speed\\": 0.0}, \\"device_id\\": \\"ABCDEFG-SASHA-TEST-DEVICE-ID\\", \\"type\\": \\"location\\", \\"account_id\\": \\"1\\"}]",
"Timestamp" : "2019-03-18T21:21:58.501Z",
"SignatureVersion" : "1",
"Signature" : "Ez/O7e3AaxOvK5Pgi/KSUW60UPOV2t7xY9vdWkaJlUd0CTdCnEmsFGN+Iw6F/OIXuAb+qEemCy0py6qUMwqw8/AU3cY8quco1Ksc4MYFdkdTAv0MjPnwgFR2i8ziaNF/d4cpyUChgKsaiscg2yoDOkf5C0WhMzhVp+jkKjRYpvgpJb2xOCUTLuWvmKRooqxKo58pYak2KzSbTGbbIaGmLNJjR5HSOLZntGT7c51WS5l4kAuWNxJ1p2nad5SLbP76FDg1GTRWKSMxl5Sn1KWKcDspiKlXvMlnSIF/kZl2YDwXucLU+C69nZopgrnUc3+6AXIEZiOC/fCzJ+SDIf9n3w==",
"SigningCertURL" : "https://sns.us-west-2.amazonaws.com/SimpleNotificationService-6aad65c2f9911b05cd53efda11f913f9.pem",
"UnsubscribeURL" : "https://sns.us-west-2.amazonaws.com/?Action=Unsubscribe&SubscriptionArn=arn:aws:sns:us-west-2:203867187697:78f6fd85-0989-4907-8db2-22688dd32c15:180ab837-4f51-475b-bb99-2d870eb32221"
}
```

From the payload above, the application content in stored in the `Message` to be decoded from above:

```
"Message" : [{
  "recorded_at": "2019-02-27T22:50:24.538000Z", 
  "data": {
    "altitude": 495.2, 
    "bearing": 90.0, 
    "location": {
      "coordinates": [-6.2755, 57.6398983], 
      "type": "Point"
    }, 
    "location_accuracy": 14.087, 
    "speed": 0.0
  }, 
  "device_id": "ABCDEFG-SASHA-TEST-DEVICE-ID", 
  "type": "location", 
  "account_id": "1"
}]
```
### Conclusion

Once you complete steps above, you will be getting Live Location on Webhook location change events for each device that belongs to you account. 

